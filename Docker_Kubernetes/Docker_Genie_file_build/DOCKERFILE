# 1. Base image (MUST be first)
FROM ubuntu:22.04

# 2. Metadata (non-build affecting)
LABEL maintainer="your@email.com"
LABEL version="1.0"

# 3. Set working directory
WORKDIR /app

# 4. Copy files (context from build directory)
COPY . .
COPY package.json ./

# 5. Run shell commands (creates new layer)
RUN apt-get update && apt-get install -y nodejs
RUN npm install

# 6. Environment variables
ENV NODE_ENV=production
ENV PORT=3000

# 7. Expose ports (documentation only)
EXPOSE 3000

# 8. Default volume mount point
VOLUME /app/data

# 9. Startup command (default, overrideable)
CMD ["npm", "start"]

# 10. Executable entrypoint (with args)
ENTRYPOINT ["nginx"]
CMD ["-g", "daemon off;"]
